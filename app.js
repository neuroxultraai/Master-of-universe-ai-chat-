import { Store } from './utils/store.js'; import { Sidebar } from './pages/_sidebar.js'; import { Login } from './pages/login.js'; import { Dashboard } from './pages/dashboard.js'; const routes={'#login':Login,'#dashboard':Dashboard}; export const store=new Store({user:null,premium:false,backend:'server'}); function requireAuth(r){ if(!store.get('user') && r!=='#login'){ location.hash='#login'; return false;} return true;} function mount(){ const root=document.getElementById('app'); root.innerHTML=''; const v=location.hash||(store.get('user')?'#dashboard':'#login'); const View=routes[v]||Dashboard; if(!requireAuth(v)) return; const layout=document.createElement('div'); layout.appendChild(Sidebar()); const main=document.createElement('main'); main.className='main'; main.appendChild(View()); layout.appendChild(main); root.appendChild(layout);} window.addEventListener('hashchange', mount); window.addEventListener('load', ()=>{ const u=store.load('user'); if(u) store.set('user',u); if(location.hash==='') location.hash = store.get('user')?'#dashboard':'#login'; mount(); });